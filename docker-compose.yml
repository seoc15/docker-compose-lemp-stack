version: '3.8'

services:
  # --- Frontend: Nginx (Tu web) ---
  nginx:
    image: nginx:latest
    container_name: asir_nginx
    ports:
      - "8081:80"
    volumes:
      - ./html:/usr/share/nginx/html
    networks:
      - asir_net
    depends_on:
      - mariadb

  # --- Backend: Base de Datos ---
  mariadb:
    image: mariadb:10.6
    container_name: asir_mariadb
    environment:
      MYSQL_ROOT_PASSWORD: rootpassword
      MYSQL_DATABASE: asir_db
      MYSQL_USER: asir_user
      MYSQL_PASSWORD: asir_password
    volumes:
      - db_data:/var/lib/mysql
    networks:
      - asir_net

  # --- Seguridad: Wazuh Agent (Simulado) ---
  # Usamos Ubuntu para garantizar que arranque sin errores de versi√≥n
  wazuh-agent:
    image: ubuntu:latest
    container_name: asir_wazuh_agent
    # Este comando mantiene el contenedor encendido "simulando" trabajo
    command: tail -f /dev/null
    networks:
      - asir_net

networks:
  asir_net:
    driver: bridge

volumes:
  db_data: